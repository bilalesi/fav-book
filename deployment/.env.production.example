# =============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# This file contains all environment variables needed for production deployment.
# All services run in Docker containers with proper orchestration.
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Replace ALL placeholder values with real production credentials
# 3. Ensure all secrets are securely generated and stored
# 4. Run: deployment/prod/deploy.sh
# =============================================================================

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection string
# For managed PostgreSQL (Neon, AWS RDS, etc.):
DATABASE_URL=postgresql://user:password@host:5432/bookmarks_prod?sslmode=require

# For Docker Compose deployment:
# DATABASE_URL=postgresql://postgres:${DB_PASSWORD}@postgres:5432/bookmarks_prod

# Database credentials (if using Docker Compose)
DB_USER=postgres
DB_PASSWORD=CHANGE_THIS_SECURE_PASSWORD
DB_NAME=bookmarks_prod

# =============================================================================
# RESTATE CONFIGURATION
# =============================================================================
# Restate server for durable workflow orchestration
# Internal Docker network addresses
RESTATE_INGRESS_URL=http://restate:8080
RESTATE_ADMIN_URL=http://restate:9070
RESTATE_SERVICE_PORT=9080

# External access (if exposing Restate publicly)
# RESTATE_PUBLIC_URL=https://restate.yourdomain.com

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================
# Authentication - CRITICAL: Generate secure secret!
# Generate with: openssl rand -base64 32
BETTER_AUTH_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING_MINIMUM_32_CHARACTERS

# Public API URL
BETTER_AUTH_URL=https://api.yourdomain.com

# CORS Configuration - Your frontend domain
CORS_ORIGIN=https://yourdomain.com

# Server Settings
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# OAuth Providers
# Twitter/X OAuth - Get from: https://developer.twitter.com/en/portal/dashboard
TWITTER_CLIENT_ID=your-twitter-client-id
TWITTER_CLIENT_SECRET=your-twitter-client-secret

# LinkedIn OAuth - Get from: https://www.linkedin.com/developers/apps
LINKEDIN_CLIENT_ID=your-linkedin-client-id
LINKEDIN_CLIENT_SECRET=your-linkedin-client-secret

# Email Service (Resend)
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY=re_your_production_resend_api_key
EMAIL_FROM=Social Bookmarks <noreply@yourdomain.com>

# =============================================================================
# WEB APPLICATION CONFIGURATION
# =============================================================================
VITE_SERVER_URL=https://api.yourdomain.com
ALCHEMY_PASSWORD=CHANGE_THIS_SECURE_PASSWORD

# =============================================================================
# AI SERVICES CONFIGURATION
# =============================================================================
# OpenAI API (recommended for production)
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=1000

# Alternative: Anthropic Claude
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key
# ANTHROPIC_MODEL=claude-3-haiku-20240307

# Alternative: Self-hosted LLM
# LM_STUDIO_API_URL=https://llm.yourdomain.com/v1
# LM_STUDIO_MODEL=your-model-name
# LM_STUDIO_MAX_TOKENS=1000

# =============================================================================
# MEDIA DOWNLOAD CONFIGURATION
# =============================================================================
# Cobalt API for media downloads
# Self-hosted: http://cobalt:9002
# Public instance: https://api.cobalt.tools
COBALT_API_URL=http://cobalt:9002
COBALT_TIMEOUT=30000

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
# S3-compatible storage (AWS S3, Cloudflare R2, MinIO, etc.)
STORAGE_ENDPOINT=https://s3.amazonaws.com
STORAGE_REGION=us-east-1
STORAGE_BUCKET=bookmarks-media
STORAGE_ACCESS_KEY=your-access-key
STORAGE_SECRET_KEY=your-secret-key

# Alternative: Local storage (not recommended for production)
# STORAGE_TYPE=local
# STORAGE_PATH=/data/media

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_AI_SUMMARIZATION=true
ENABLE_MEDIA_DOWNLOAD=true
MAX_MEDIA_SIZE_MB=500
MAX_SUMMARY_LENGTH=500
WORKFLOW_RETRY_ATTEMPTS=3
WORKFLOW_RETRY_DELAY_MS=5000

# Storage Limits
MAX_STORAGE_GB=100

# =============================================================================
# SECURITY & RATE LIMITING
# =============================================================================
# Rate limiting configuration
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=60000

# Session configuration
SESSION_MAX_AGE=604800000
SESSION_UPDATE_AGE=86400000

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
# Sentry (optional - for error tracking)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Log configuration
LOG_FORMAT=json
LOG_LEVEL=info

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
# Resource limits (used by docker-compose.yml)
POSTGRES_MAX_CONNECTIONS=100
RESTATE_MEMORY_LIMIT=2g
API_MEMORY_LIMIT=1g
WEB_MEMORY_LIMIT=512m

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Backup settings (used by backup scripts)
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=bookmarks-backups
BACKUP_SCHEDULE=0 2 * * *

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================
# Deployment settings
DEPLOYMENT_ENVIRONMENT=production
DEPLOYMENT_VERSION=1.0.0

# Health check configuration
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# =============================================================================
# SECURITY CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
# 
# ✓ All CHANGE_THIS_* values are replaced with secure credentials
# ✓ BETTER_AUTH_SECRET is a strong random string (min 32 chars)
# ✓ Database password is strong and unique
# ✓ All API keys are production keys (not test/development keys)
# ✓ CORS_ORIGIN matches your actual frontend domain
# ✓ SSL/TLS is enabled for all external connections
# ✓ Firewall rules are configured to restrict access
# ✓ Backup strategy is in place and tested
# ✓ Monitoring and alerting are configured
# ✓ This file is NOT committed to version control
#
# =============================================================================
# CREDENTIAL GENERATION COMMANDS
# =============================================================================
#
# Generate BETTER_AUTH_SECRET:
#   openssl rand -base64 32
#
# Generate DB_PASSWORD:
#   openssl rand -base64 24
#
# Generate ALCHEMY_PASSWORD:
#   openssl rand -base64 16
#
# =============================================================================
